<apex:page standardController="VisitOps__Agenda__c" recordSetVar="agendas">
    <!--====================================================--> 
<!--Name: Presenter View Button PageForAgendaSession                                       
<!--Copyright :VisitOps                                                  
<!--====================================================-->
<!--====================================================-->
<!-- Purpose: It opens Agenda PrintView Page(Presenter View) on click of Presenter View Button on Agenda Session                                                                                                   
<!---------                                                                                                               
<!--====================================================-->
<!--====================================================-->
<!-- History                                                                                                             
<!-- -------                                                                                                        
<!-- VERSION  AUTHOR           DATE              DETAIL                     RELEASE/CSR   
<!--   1.0 -  Tanuj      	   03/04/2019      INITIAL DEVELOPMENT                              
                    
<!--====================================================-->
    
    <apex:includeScript value="../../soap/ajax/20.0/connection.js"/>
    <script>
    sforce.connection.sessionId = "{!$Api.Session_ID}";
    var namespacePrefix = 
        '{!IF( OR(ISBLANK($Label.NamespacePrefixForSchema), LOWER($Label.NamespacePrefixForSchema) == 'null') , '', $Label.NamespacePrefixForSchema)}'; 
    
    
    var parsedUrl = new URL(window.location.href);
    var id = parsedUrl.searchParams.get("id");
    console.log(parsedUrl.searchParams.get("id")); 
    if('{!$User.UITheme}'=='Theme4d')  
    { 
        sforce.one.navigateToURL('/apex/'+ namespacePrefix + '{!$Label.AgendaPrint}?visitId='+id+'&viewType={!$Label.AgendaPresenterView}');
    } 
    else{  
        window.open('/apex/'+ namespacePrefix +'{!$Label.AgendaPrint}?visitId='+id+'&viewType={!$Label.AgendaPresenterView}&redirectURL=/'+id,'_self');  	// Code Change to Open New VF Page in Same Tab 
    }
    </script>  
</apex:page>